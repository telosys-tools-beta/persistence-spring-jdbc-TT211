/*
 * Created on $today.date ( Time $today.time )
 * Generated by $generator.name ( version $generator.version )
 */
package ${target.javaPackageFromFolder($TEST_SRC)};

import java.sql.Connection;
import java.sql.SQLException;
import java.sql.Statement;

import javax.sql.DataSource;

/**
 * Utility class for JUnit test cases 
 * 
 * @author Telosys Tools
 *
 */
public class DAOTestUtil {
	
    /**
     * Creates a table that will be used by the DAO tests 
     * @param createTableSQL
     */
    public static void initDatabase(String createTableSQL) { 
    	
    	System.out.println("===== initDatabase... ");
    	
    	//--- The datasource as defined in the 'jdbc properties' file  
    	DataSource datasource = DAOProvider.getDataSource();
    	
    	//--- Execute the CREATE TABLE SQL statement
    	try {
			createTable(createTableSQL, datasource);
		} catch (SQLException e) {
			e.printStackTrace();
			throw new RuntimeException("Error on 'create table'");
		}
    }
    
    private static void createTable(String createTableSQL, DataSource datasource) throws SQLException {
    	Connection conn = datasource.getConnection();
    	Statement stmt = conn.createStatement();
    	int r = stmt.executeUpdate(createTableSQL);
    	System.out.println("create table status : " + r);
    	stmt.close();
    	conn.close();
    }
}
